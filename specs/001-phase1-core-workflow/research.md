# Research & Decisions: Phase 1 Core Workflow

**Branch**: `001-phase1-core-workflow`  
**Date**: 2026-01-20  
**Spec**: [spec.md](./spec.md)

This document resolves planning decisions needed to proceed from specification to design artifacts.

## Decisions

### 1) Job reference uniqueness

- **Decision**: Job reference number is unique across the whole system.
- **Rationale**: Prevents confusion in exports, file naming, and cross-team communication.
- **Alternatives considered**:
  - Unique per client/production (rejected: still allows duplicates across crews/PMs)
  - Not unique (rejected: high risk of ambiguity)

### 2) File areas & access model

- **Decision**: Each Job has two file areas: **Shared** and **Internal**.
  - Shared: visible to all users with Job access.
  - Internal: visible only to Admin/PM/Senior Technician on that Job.
- **Rationale**: Matches real workflows (crew-facing vs internal planning/admin) with minimal complexity.
- **Alternatives considered**:
  - Single shared area only (rejected: cannot hide internal admin/planning docs)
  - Per-file ACLs (rejected: too complex for Phase 1)

### 3) File upload permissions

- **Decision**: Only Admin/PM/Senior Technician can upload files. Technician/Warehouse are download-only.
- **Rationale**: Prevents accidental clutter and keeps responsibility with planning roles.
- **Alternatives considered**:
  - Everyone uploads (rejected: higher content governance overhead)
  - Only Admin/PM uploads (rejected: slows Senior Tech workflows)

### 4) Paperwork concurrency handling

- **Decision**: Plug-up sheet uses **last write wins (silent)** on concurrent saves.
- **Rationale**: Keeps Phase 1 implementation simple and consistent with chosen user expectation.
- **Trade-off**: Risk of overwriting another user’s changes; mitigated by lightweight audit log + “last edited by/at”.
- **Alternatives considered**:
  - Conflict detection + refresh/retry (rejected: additional UX/tech complexity)
  - Edit locking (rejected: can block teams during prep)

### 5) PDF export permissions

- **Decision**: Warehouse users can export/download the plug-up sheet PDF.
- **Rationale**: Warehouse must print/prepare without depending on PM/Senior Tech.

### 6) PDF generation ownership

- **Decision**: PDF export is generated by backend/worker (not in-browser) and is reproducible.
- **Rationale**: Consistent with constitution; reduces machine-to-machine differences.
- **Alternatives considered**:
  - Browser-side PDF (rejected: violates constitution; inconsistent rendering)

### 7) API contract posture

- **Decision**: API endpoints enforce all permission checks (no UI-only authorization).
- **Rationale**: Non-negotiable security requirement for Job-scoped access.

## Open items (deferred to implementation)

These are intentionally deferred because they do not block correct planning artifacts:

- Exact PDF rendering engine choice.
- Exact object storage provider configuration values.
- Final UI component library choices.
